[
    {
        "daily_accounts_update": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "model": "accounts",
            "update_keys": [
                "id"
            ],
            "query": {
                "response_datas_key": "elements",
                "template": "{base}{api_name}?{q}&{count}&{start}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adAccountsV2"
                    },
                    {
                        "name": "q",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "search"
                    },
                    {
                        "name": "count",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 300
                    },
                    {
                        "name": "start",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 0
                    }
                ]
            }
        }
    },
    {
        "daily_campaigns_update": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "model": "campaigns",
            "update_keys": [
                "id"
            ],
            "data_source": {
                "name": "campaigns",
                "raw_sql": "select distinct(id) from {schema}.accounts"
            },
            "query": {
                "response_datas_key": "elements",
                "template": "{base}{api_name}?{q}&{search_account_values}&{count}&{start}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adCampaignsV2"
                    },
                    {
                        "name": "q",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "search"
                    },
                    {
                        "name": "search_account_values",
                        "url_key_string": "search.account.values[0]",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "kwarg",
                        "template": "urn:li:sponsoredAccount:{}"
                    },
                    {
                        "name": "count",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 300
                    },
                    {
                        "name": "start",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 0
                    }
                ]
            }
        }
    },
    {
        "campaign_groups_daily_update": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "model": "campaign_groups",
            "update_keys": [
                "id"
            ],
            "query": {
                "response_datas_key": "elements",
                "template": "{base}{api_name}?{q}&{count}&{start}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adCampaignGroupsV2"
                    },
                    {
                        "name": "q",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "search"
                    },
                    {
                        "name": "count",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 300
                    },
                    {
                        "name": "start",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 0
                    }
                ]
            }
        }
    },
    {
        "creative_sponsored_video_daily_update": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "creative_id"
            ],
            "model": "creative_sponsored_video",
            "update_keys": [
                "creative_id"
            ],
            "data_source": {
                "name": "creatives_id",
                "raw_sql": "select distinct(creative_id) from {schema}.social_metrics where creative_id not in (select distinct(creative_id) from {schema}.creative_sponsored_video) and creative_type = 'SPONSORED_VIDEO'"
            },
            "query": {
                "response_datas_key": null,
                "template": "{base}{api_name}/{creative_id}?{count}&{start}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adCreativesV2"
                    },
                    {
                        "name": "creative_id",
                        "type": "db",
                        "data_source_name": "creatives_id",
                        "source_key": "creative_id",
                        "output_type": "arg"
                    },
                    {
                        "name": "count",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 300
                    },
                    {
                        "name": "start",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 0
                    }
                ]
            }
        }
    },
    {
        "daily_social_metrics_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "social_metrics",
            "data_source": {
                "name": "accounts",
                "raw_sql": "select distinct(id) from {schema}.accounts"
            },
            "query": {
                "response_datas_key": "elements",
                "template": "{base}{api_name}?{q}&{search_account_values}&{dateRange_start_day}&{dateRange_start_month}&{dateRange_start_year}&{timeGranularity}&{pivot}&{fields}&{projection}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adAnalyticsV2"
                    },
                    {
                        "name": "q",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "analytics"
                    },
                    {
                        "name": "search_account_values",
                        "url_key_string": "accounts[0]",
                        "type": "db",
                        "data_source_name": "accounts",
                        "source_key": "id",
                        "output_type": "kwarg",
                        "template": "urn:li:sponsoredAccount:{}"
                    },
                    {
                        "name": "dateRange_start_day",
                        "url_key_string": "dateRange.start.day",
                        "type": "part_of_date",
                        "part_of_date_name": "day",
                        "offset_type": "from_today",
                        "offset_value": "2",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_start_month",
                        "url_key_string": "dateRange.start.month",
                        "type": "part_of_date",
                        "part_of_date_name": "month",
                        "offset_type": "from_today",
                        "offset_value": "2",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_start_year",
                        "url_key_string": "dateRange.start.year",
                        "type": "part_of_date",
                        "part_of_date_name": "year",
                        "offset_type": "from_today",
                        "offset_value": "2",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_end_day",
                        "url_key_string": "dateRange.end.day",
                        "type": "part_of_date",
                        "part_of_date_name": "day",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_end_month",
                        "url_key_string": "dateRange.end.month",
                        "type": "part_of_date",
                        "part_of_date_name": "month",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_end_year",
                        "url_key_string": "dateRange.end.year",
                        "type": "part_of_date",
                        "part_of_date_name": "year",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "timeGranularity",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "DAILY"
                    },
                    {
                        "name": "pivot",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "CREATIVE"
                    },
                    {
                        "name": "fields",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "likes,dateRange,impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue"
                    },
                    {
                        "name": "projection",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "(*,elements*(likes,dateRange(*),impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue~))"
                    }
                ]
            }
        }
    },
    {
        "creative_sponsored_video__creative_name_daily_update": {
            "actions": [
                "partial_update"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "creative_sponsored_video",
            "update_keys": [
                "ugc_ref"
            ],
            "db_query": {
                "type": "update",
                "fields": [
                    {
                        "table_field_name": "creative_name",
                        "api_result_path": [
                            "adContext",
                            "dscName"
                        ]
                    }
                ],
                "keys": [
                    {
                        "table_field_name_used_as_key": "ugc_ref",
                        "api_result_path": [
                            "id"
                        ]
                    }
                ]
            },
            "data_source": {
                "name": "ugc_refs",
                "raw_sql": "select ugc_ref from {schema}.creative_sponsored_video where creative_name is null"
            },
            "query": {
                "response_datas_key": null,
                "template": "{base}/{api_name}/{ugc_ref}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/rest"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "posts"
                    },
                    {
                        "name": "ugc_ref",
                        "type": "db",
                        "data_source_name": "ugc_refs",
                        "source_key": "ugc_ref",
                        "output_type": "arg",
                        "force_url_encoding": null
                    }
                ]
            },
            "request_header": {
                "Linkedin-Version": "202206",
                "X-Restli-Protocol-Version": "2.0.0"
            }
        }
    },
    {
        "creative_sponsored_update_daily_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "model": "creative_sponsored_update",
            "update_keys": [
                "creative_id"
            ],
            "data_source": {
                "name": "creatives_id",
                "raw_sql": "select distinct(creative_id) from {schema}.social_metrics where creative_id not in (select creative_id from {schema}.creative_sponsored_update) and creative_type = 'SPONSORED_STATUS_UPDATE'"
            },
            "query": {
                "response_datas_key": null,
                "template": "{base}{api_name}/{creative_id}?{projection}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adCreativesV2"
                    },
                    {
                        "name": "creative_id",
                        "type": "db",
                        "data_source_name": "creatives_id",
                        "source_key": "creative_id",
                        "output_type": "arg"
                    },
                    {
                        "name": "projection",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "(id,variables(data(*,com.linkedin.ads.SponsoredUpdateCreativeVariables(*,share~(subject,text(text),content(contentEntities(*(description,entityLocation,title))))))))"
                    }
                ]
            }
        }
    },
    {
        "creative_sponsored_update_daily_update_old": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "request_data_source": "redshift",
            "model": "creative_sponsored_update",
            "url": {
                "base": "https://api.linkedin.com/v2/",
                "category": "adCreativesV2",
                "q": null,
                "params": {
                    "db": {
                        "search.account.values[0]": {
                            "type": [
                                "db",
                                "args",
                                "rawsql"
                            ],
                            "kwargs_fields": [],
                            "db_fields": [],
                            "args_fields": [
                                "creative_id"
                            ],
                            "raw_sql": "select distinct(creative_id) from {schema}.social_metrics where creative_id not in (select creative_id from {schema}.creative_sponsored_update) and creative_type = 'SPONSORED_STATUS_UPDATE'",
                            "url_query_parameter_template": "/{}"
                        }
                    },
                    "dynamics": {},
                    "statics": {
                        "projection": "(id,variables(data(*,com.linkedin.ads.SponsoredUpdateCreativeVariables(*,share~(subject,text(text),content(contentEntities(*(description,entityLocation,title))))))))"
                    }
                }
            },
            "request": {
                "header": {
                    "X-Restli-Protocol-Version": "2.0.0"
                }
            }
        }
    },
    {
        "creative_text_ads_daily_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "request_data_source": "redshift",
            "model": "creative_text_ads",
            "url": {
                "base": "https://api.linkedin.com/v2/",
                "category": "adCreativesV2",
                "q": null,
                "params": {
                    "db": {
                        "_": {
                            "type": [
                                "db",
                                "args",
                                "rawsql"
                            ],
                            "raw_sql": "select distinct(creative_id) from {schema}.social_metrics where creative_id not in (select id from {schema}.creative_text_ads) and creative_type = 'TEXT_AD'",
                            "url_query_parameter_template": "/{}"
                        }
                    },
                    "dynamics": {},
                    "statics": {}
                }
            },
            "request": {
                "header": {
                    "X-Restli-Protocol-Version": "2.0.0"
                }
            }
        }
    },
    {
        "creative_url_daily_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": true,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "creative_id"
            ],
            "model": "creative_url",
            "update_keys": [
                "creative_id"
            ],
            "data_source": {
                "name": "creatives_id",
                "raw_sql": "select distinct(creative_id) from {schema}.social_metrics where creative_id not in (select creative_id from {schema}.creative_url) and creative_type = 'SPONSORED_STATUS_UPDATE'"
            },
            "fields_to_add_to_api_result": [
                {
                    "name": "creative_id",
                    "origin_key": "creative_id",
                    "destination_key": "creative_id"
                }
            ],
            "query": {
                "response_datas_key": null,
                "template": "{base}{api_name}/{creative_id}?{projection}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adCreativesV2"
                    },
                    {
                        "name": "creative_id",
                        "type": "db",
                        "data_source_name": "creatives_id",
                        "source_key": "creative_id",
                        "output_type": "arg"
                    },
                    {
                        "name": "projection",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "(variables(data(*,com.linkedin.ads.SponsoredUpdateCreativeVariables(*,share~(*)))))"
                    }
                ]
            }
        }
    },
    {
        "creative_url_3_months_daily_update": {
            "actions": [
                "update"
            ],
            "exclude_existing_in_db": true,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "creative_id"
            ],
            "model": "creative_url",
            "update_keys": [
                "creative_id"
            ],
            "data_source": {
                "name": "creatives_id",
                "raw_sql": "select distinct(creative_id) from {schema}.social_metrics"
            },
            "fields_to_add_to_api_result": [
                {
                    "name": "creative_id",
                    "origin_key": "creative_id",
                    "destination_key": "creative_id"
                }
            ],
            "query": {
                "response_datas_key": null,
                "template": "{base}{api_name}/{creative_id}?{projection}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adCreativesV2"
                    },
                    {
                        "name": "creative_id",
                        "type": "db",
                        "data_source_name": "creatives_id",
                        "source_key": "creative_id",
                        "output_type": "arg"
                    },
                    {
                        "name": "projection",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "(variables(data(*,com.linkedin.ads.SponsoredUpdateCreativeVariables(*,share~(*)))))"
                    }
                ]
            }
        }
    },
    {
        "account_pivot_campaign_daily_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "account_pivot_campaign",
            "data_source": {
                "name": "accounts",
                "raw_sql": "select distinct(id) from {schema}.accounts"
            },
            "query": {
                "response_datas_key": "elements",
                "template": "{base}{api_name}?{q}&{search_account_values}&{timeGranularity}&{pivot}&{fields}&{projection}&{dateRange_start_day}&{dateRange_start_month}&{dateRange_start_year}&{dateRange_end_day}&{dateRange_end_month}&{dateRange_end_year}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.linkedin.com/v2/"
                    },
                    {
                        "name": "api_name",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "adAnalyticsV2"
                    },
                    {
                        "name": "q",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "analytics"
                    },
                    {
                        "name": "search_account_values",
                        "url_key_string": "accounts[0]",
                        "type": "db",
                        "data_source_name": "accounts",
                        "source_key": "id",
                        "output_type": "kwarg",
                        "template": "urn:li:sponsoredAccount:{}"
                    },
                    {
                        "name": "timeGranularity",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "DAILY"
                    },
                    {
                        "name": "pivot",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "CAMPAIGN"
                    },
                    {
                        "name": "fields",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "pivotValue,dateRange,impressions,costInUsd,clicks,shares,pivot"
                    },
                    {
                        "name": "projection",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "(*,elements*(pivotValue~(account, id, name, status, campaignGroup, type),dateRange(*),impressions,costInUsd,clicks,shares,pivot))"
                    },
                    {
                        "name": "dateRange_start_day",
                        "url_key_string": "dateRange.start.day",
                        "type": "part_of_date",
                        "part_of_date_name": "day",
                        "offset_type": "from_today",
                        "offset_value": "2",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_start_month",
                        "url_key_string": "dateRange.start.month",
                        "type": "part_of_date",
                        "part_of_date_name": "month",
                        "offset_type": "from_today",
                        "offset_value": "2",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_start_year",
                        "url_key_string": "dateRange.start.year",
                        "type": "part_of_date",
                        "part_of_date_name": "year",
                        "offset_type": "from_today",
                        "offset_value": "2",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_end_day",
                        "url_key_string": "dateRange.end.day",
                        "type": "part_of_date",
                        "part_of_date_name": "day",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_end_month",
                        "url_key_string": "dateRange.end.month",
                        "type": "part_of_date",
                        "part_of_date_name": "month",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "dateRange_end_year",
                        "url_key_string": "dateRange.end.year",
                        "type": "part_of_date",
                        "part_of_date_name": "year",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    }
                ]
            }
        }
    },
    {
        "account_pivot_campaign_daily_update_old": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "response_datas_key": "elements",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "account_pivot_campaign",
            "url": {
                "response_datas_key": "elements",
                "base": "https://api.linkedin.com/v2/",
                "category": "adAnalyticsV2",
                "q": "analytics",
                "params": {
                    "db": {
                        "_": {
                            "type": "db",
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "id",
                                    "urn:li:sponsoredAccount:{}",
                                    "accounts"
                                ]
                            ],
                            "db_fields": [],
                            "filter_model": "accounts",
                            "all_fields": [
                                "id"
                            ]
                        }
                    },
                    "date_range": {
                        "split_allowed": true,
                        "offset_unity": "days",
                        "start_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "start_day",
                            "url_params": {
                                "dateRange.start.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.start.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.start.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        },
                        "end_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "end_day",
                            "url_params": {
                                "dateRange.end.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.end.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.end.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        }
                    },
                    "statics": {
                        "timeGranularity": "DAILY",
                        "start": "0",
                        "pivot": "CAMPAIGN",
                        "fields": "pivotValue,dateRange,impressions,costInUsd,clicks,shares,pivot",
                        "projection": "(*,elements*(pivotValue~(account, id, name, status, campaignGroup, type),dateRange(*),impressions,costInUsd,clicks,shares,pivot))"
                    }
                }
            },
            "request": {
                "header": null
            }
        }
    },
    {
        "pivot_member_country_monthly_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "pivot_member_country",
            "url": {
                "base": "https://api.linkedin.com/v2/",
                "category": "adAnalyticsV2",
                "q": "analytics",
                "response_datas_key": "elements",
                "params": {
                    "db": {
                        "campaigns[0]": {
                            "type": [
                                "db",
                                "args",
                                "rawsql"
                            ],
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "campaign_id",
                                    "urn:li:sponsoredCampaign:{}",
                                    "campaigns"
                                ]
                            ],
                            "db_fields": [
                                {
                                    "origin_key": "campaign_id",
                                    "destination_key": "facet_id"
                                }
                            ],
                            "raw_sql_2": "select distinct(campaign_id) from {schema}.account_pivot_campaign where start_date between (select date_trunc('month', getdate() - interval '1 month')) and (select last_day(getdate() - interval '1 month'))",
                            "raw_sql": "select distinct(campaign_id) from {schema}.account_pivot_campaign"
                        }
                    },
                    "date_range": {
                        "split_allowed": true,
                        "offset_unity": "months",
                        "start_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "start_day",
                            "url_params": {
                                "dateRange.start.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.start.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.start.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        },
                        "end_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "end_day",
                            "url_params": {
                                "dateRange.end.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.end.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.end.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        }
                    },
                    "statics": {
                        "timeGranularity": "MONTHLY",
                        "start": "0",
                        "pivot": "MEMBER_COUNTRY_V2",
                        "fields": "pivotValue,dateRange,impressions,costInUsd,clicks,shares,pivot",
                        "projection": "(*,elements*(pivotValue~,dateRange(*),impressions,costInUsd,clicks,shares,pivot))"
                    }
                }
            },
            "request": {
                "header": null
            }
        }
    },
    {
        "pivot_member_county_monthly_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "pivot_member_county",
            "url": {
                "base": "https://api.linkedin.com/v2/",
                "category": "adAnalyticsV2",
                "q": "analytics",
                "response_datas_key": "elements",
                "params": {
                    "db": {
                        "campaigns[0]": {
                            "type": [
                                "db",
                                "args",
                                "rawsql"
                            ],
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "campaign_id",
                                    "urn:li:sponsoredCampaign:{}",
                                    "campaigns"
                                ]
                            ],
                            "db_fields": [
                                {
                                    "origin_key": "campaign_id",
                                    "destination_key": "facet_id"
                                }
                            ],
                            "raw_sql_2": "select distinct(campaign_id) from {schema}.account_pivot_campaign where start_date between (select date_trunc('month', getdate() - interval '1 month')) and (select last_day(getdate() - interval '1 month'))",
                            "raw_sql": "select distinct(campaign_id) from {schema}.account_pivot_campaign"
                        }
                    },
                    "date_range": {
                        "split_allowed": true,
                        "offset_unity": "months",
                        "start_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "start_day",
                            "url_params": {
                                "dateRange.start.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.start.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.start.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        },
                        "end_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "end_day",
                            "url_params": {
                                "dateRange.end.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.end.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.end.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        }
                    },
                    "statics": {
                        "timeGranularity": "MONTHLY",
                        "start": "0",
                        "pivot": "MEMBER_COUNTY",
                        "fields": "pivotValue,dateRange,impressions,costInUsd,clicks,shares,pivot",
                        "projection": "(*,elements*(pivotValue~,dateRange(*),impressions,costInUsd,clicks,shares,pivot))"
                    }
                }
            },
            "request": {
                "header": null
            }
        }
    },
    {
        "pivot_job_title_monthly_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "response_datas_key": "elements",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "pivot_job_title",
            "url": {
                "response_datas_key": "elements",
                "base": "https://api.linkedin.com/v2/",
                "category": "adAnalyticsV2",
                "q": "analytics",
                "params": {
                    "db": {
                        "_": {
                            "type": "db rawsql",
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "campaign_id",
                                    "urn:li:sponsoredCampaign:{}",
                                    "campaigns[0]"
                                ]
                            ],
                            "db_fields": [
                                {
                                    "origin_key": "campaign_id",
                                    "destination_key": "facet_id"
                                }
                            ],
                            "all_fields": [
                                "campaign_id"
                            ],
                            "raw_sql_2": "select distinct(campaign_id) from {schema}.account_pivot_campaign where start_date between (select date_trunc('month', getdate() - interval '1 month')) and (select last_day(getdate() - interval '1 month'))",
                            "raw_sql": "select distinct(campaign_id) from {schema}.account_pivot_campaign"
                        }
                    },
                    "date_range": {
                        "split_allowed": true,
                        "offset_unity": "months",
                        "start_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "start_day",
                            "url_params": {
                                "dateRange.start.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.start.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.start.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        },
                        "end_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "end_day",
                            "url_params": {
                                "dateRange.end.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.end.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.end.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        }
                    },
                    "statics": {
                        "timeGranularity": "MONTHLY",
                        "pivot": "MEMBER_JOB_TITLE",
                        "fields": "externalWebsiteConversions,dateRange,impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue",
                        "projection": "(*,elements*(externalWebsiteConversions,dateRange(*),impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue~))"
                    }
                }
            },
            "request": {
                "header": null
            }
        }
    },
    {
        "pivot_member_organization_monthly_update": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "response_datas_key": "elements",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "pivot_member_company",
            "url": {
                "response_datas_key": "elements",
                "base": "https://api.linkedin.com/v2/",
                "category": "adAnalyticsV2",
                "q": "analytics",
                "params": {
                    "db": {
                        "_": {
                            "type": "db rawsql",
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "campaign_id",
                                    "urn:li:sponsoredCampaign:{}",
                                    "campaigns[0]"
                                ]
                            ],
                            "db_fields": [
                                {
                                    "origin_key": "campaign_id",
                                    "destination_key": "facet_id"
                                }
                            ],
                            "all_fields": [
                                "campaign_id"
                            ],
                            "raw_sql_2": "select distinct(campaign_id) from {schema}.account_pivot_campaign where start_date between (select date_trunc('month', getdate() - interval '1 month')) and (select last_day(getdate() - interval '1 month'))",
                            "raw_sql": "select distinct(campaign_id) from {schema}.account_pivot_campaign"
                        }
                    },
                    "date_range": {
                        "split_allowed": true,
                        "offset_unity": "months",
                        "start_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "start_day",
                            "url_params": {
                                "dateRange.start.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.start.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.start.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        },
                        "end_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "end_day",
                            "url_params": {
                                "dateRange.end.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.end.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.end.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        }
                    },
                    "statics": {
                        "timeGranularity": "MONTHLY",
                        "pivot": "MEMBER_COMPANY",
                        "fields": "externalWebsiteConversions,dateRange,impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue",
                        "projection": "(*,elements*(externalWebsiteConversions,dateRange(*),impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue~(localizedName)))"
                    }
                }
            },
            "request": {
                "header": null
            }
        }
    },
    {
        "pivot_member_organization_full_daily_update": {
            "actions": [
                "erase",
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "response_datas_key": "elements",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "pivot_member_company_full",
            "url": {
                "response_datas_key": "elements",
                "base": "https://api.linkedin.com/v2/",
                "category": "adAnalyticsV2",
                "q": "analytics",
                "params": {
                    "db": {
                        "_": {
                            "type": "db rawsql",
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "id",
                                    "urn:li:sponsoredCampaign:{}",
                                    "campaigns[0]"
                                ]
                            ],
                            "db_fields": [
                                {
                                    "origin_key": "id",
                                    "destination_key": "facet_id"
                                }
                            ],
                            "all_fields": [
                                "campaign_id"
                            ],
                            "raw_sql": "select distinct(id) from {schema}.campaigns"
                        }
                    },
                    "date_range": {
                        "offset_unity": "days",
                        "start_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "start_day",
                            "url_params": {
                                "dateRange.start.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.start.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.start.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        },
                        "end_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "end_day",
                            "url_params": {
                                "dateRange.end.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.end.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.end.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        }
                    },
                    "statics": {
                        "timeGranularity": "ALL",
                        "pivot": "MEMBER_COMPANY",
                        "fields": "externalWebsiteConversions,dateRange,impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue",
                        "projection": "(*,elements*(externalWebsiteConversions,dateRange(*),impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue~(localizedName)))"
                    }
                }
            },
            "request": {
                "header": null
            }
        }
    },
    {
        "pivot_member_country_full_daily_update": {
            "actions": [
                "erase",
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "pivot_member_country_full",
            "url": {
                "base": "https://api.linkedin.com/v2/",
                "category": "adAnalyticsV2",
                "q": "analytics",
                "response_datas_key": "elements",
                "params": {
                    "db": {
                        "campaigns[0]": {
                            "type": [
                                "db",
                                "args",
                                "rawsql"
                            ],
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "id",
                                    "urn:li:sponsoredCampaign:{}",
                                    "campaigns"
                                ]
                            ],
                            "db_fields": [
                                {
                                    "origin_key": "id",
                                    "destination_key": "facet_id"
                                }
                            ],
                            "raw_sql": "select distinct(id) from {schema}.campaigns"
                        }
                    },
                    "date_range": {
                        "offset_unity": "days",
                        "start_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "start_day",
                            "url_params": {
                                "dateRange.start.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.start.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.start.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        },
                        "end_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "end_day",
                            "url_params": {
                                "dateRange.end.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.end.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.end.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        }
                    },
                    "statics": {
                        "timeGranularity": "ALL",
                        "start": "0",
                        "pivot": "MEMBER_COUNTY",
                        "fields": "pivotValue,dateRange,impressions,costInUsd,clicks,shares,pivot",
                        "projection": "(*,elements*(pivotValue~,dateRange(*),impressions,costInUsd,clicks,shares,pivot))"
                    }
                }
            },
            "request": {
                "header": null
            }
        }
    },
    {
        "pivot_job_title_daily_full_update": {
            "actions": [
                "erase",
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "linkedin",
            "response_datas_key": "elements",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "pivot_job_title_full",
            "url": {
                "response_datas_key": "elements",
                "base": "https://api.linkedin.com/v2/",
                "category": "adAnalyticsV2",
                "q": "analytics",
                "params": {
                    "db": {
                        "_": {
                            "type": "db rawsql",
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "id",
                                    "urn:li:sponsoredCampaign:{}",
                                    "campaigns[0]"
                                ]
                            ],
                            "db_fields": [
                                {
                                    "origin_key": "id",
                                    "destination_key": "facet_id"
                                }
                            ],
                            "all_fields": [
                                "campaign_id"
                            ],
                            "raw_sql": "select distinct(id) from {schema}.campaigns"
                        }
                    },
                    "date_range": {
                        "offset_unity": "days",
                        "start_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "start_day",
                            "url_params": {
                                "dateRange.start.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.start.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.start.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        },
                        "end_date": {
                            "type": "group",
                            "offset_type": "from_today",
                            "offset_value": "1",
                            "offset_range_position": "end_day",
                            "url_params": {
                                "dateRange.end.day": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{day}",
                                    "offset": ""
                                },
                                "dateRange.end.month": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{month}"
                                },
                                "dateRange.end.year": {
                                    "type": "filter_by",
                                    "value_type": "date",
                                    "url_query_parameter_value": "{year}"
                                }
                            }
                        }
                    },
                    "statics": {
                        "timeGranularity": "ALL",
                        "pivot": "MEMBER_JOB_TITLE",
                        "fields": "externalWebsiteConversions,dateRange,impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue",
                        "projection": "(*,elements*(externalWebsiteConversions,dateRange(*),impressions,costInUsd,clicks,shares,costInLocalCurrency,pivot,pivotValue~))"
                    }
                }
            },
            "request": {
                "header": null
            }
        }
    }
]