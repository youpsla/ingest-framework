[
    {
        "contacts": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "exclude_key": "email",
            "source": "hubspot",
            "destination": "redshift",
            "destination_unique_keys": [
                "email"
            ],
            "request_data_source": "redshift",
            "update_key": "email",
            "model": "contacts",
            "url": {
                "response_data_key": [
                    "results"
                ],
                "params": {},
                "statics": {
                    "limit": "1000"
                }
            }
        }
    },
    {
        "contacts_recently_updated": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "model": "contacts",
            "update_key": "id",
            "query": {
                "template": "{base}?{limit}&{offset}",
                "response_datas_key": "events",
                "base": "https://api.hubapi.com/contacts/v1/lists/recently_updated/contacts/recent",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/events"
                    },
                    {
                        "name": "emailCampaignId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "appId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "app_id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1000
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": ""
                    },
                    {
                        "name": "eventType",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "FORWARD"
                    },
                    {
                        "name": "startTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "start",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "endTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    }
                ]
            }
        }
    },
    {
        "companies": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "exclude_key": "id",
            "source": "hubspot",
            "destination": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "request_data_source": "redshift",
            "update_key": "id",
            "model": "companies",
            "url": {
                "type": "service",
                "response_data_key": [
                    "results"
                ]
            }
        }
    },
    {
        "events": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": false,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "events",
            "url": {
                "type": "service",
                "response_data_key": [
                    "results"
                ],
                "params": {
                    "db": {
                        "_": {
                            "type": "db",
                            "args_fields": [],
                            "kwargs_fields": [
                                [
                                    "id",
                                    "{}",
                                    "object_id"
                                ]
                            ],
                            "filter_model": "contacts",
                            "all_fields": [
                                "id"
                            ]
                        }
                    },
                    "statics": {
                        "object_type": "contacts"
                    }
                }
            }
        }
    },
    {
        "campaigns": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "exclude_key": "id",
            "source": "hubspot",
            "destination": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "request_data_source": "redshift",
            "model": "campaigns",
            "update_key": "id",
            "query": {
                "response_datas_key": "campaigns",
                "template": "{base}?{limit}&{offset}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/campaigns"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1000
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": ""
                    }
                ]
            }
        }
    },
    {
        "companies_2": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "exclude_key": "id",
            "source": "hubspot",
            "destination": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "request_data_source": "redshift",
            "model": "companies",
            "update_key": "id",
            "url": {
                "response_datas_key": "campaigns",
                "template": "{base}/{company_id}/{association_type}?{limit}&{offset}",
                "base": "https://api.hubapi.com/email/public/v1/campaigns",
                "params": {}
            }
        }
    },
    {
        "campaign_details": {
            "actions": [
                "insert",
                "update"
            ],
            "exclude_existing_in_db": true,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "model": "campaign_details",
            "update_key": "id",
            "data_source": {
                "name": "campaigns",
                "raw_sql": "select distinct(id) from {schema}.campaigns"
            },
            "query": {
                "response_datas_key": null,
                "template": "{base}/{id}",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/campaigns"
                    },
                    {
                        "name": "id",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "arg"
                    }
                ]
            }
        }
    },
    {
        "email_events_click_since_2022": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": true,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "data_source": {
                "name": "campaigns",
                "raw_sql": "select id, app_id from {schema}.campaigns"
            },
            "model": "email_events",
            "update_key": "id",
            "query": {
                "template": "{base}?{emailCampaignId}&{appId}&{limit}&{offset}&{startTimestamp}&{endTimestamp}&{eventType}",
                "response_datas_key": "events",
                "base": "https://api.hubapi.com/email/public/v1/events",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/events"
                    },
                    {
                        "name": "emailCampaignId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "appId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "app_id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1000
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": ""
                    },
                    {
                        "name": "eventType",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "CLICK"
                    },
                    {
                        "name": "startTimestamp",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1640995200000
                    },
                    {
                        "name": "endTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    }
                ]
            }
        }
    },
    {
        "email_events_open_since_2022": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": true,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "data_source": {
                "name": "campaigns",
                "raw_sql": "select id, app_id from {schema}.campaigns"
            },
            "model": "email_events",
            "update_key": "id",
            "query": {
                "template": "{base}?{emailCampaignId}&{appId}&{limit}&{offset}&{startTimestamp}&{endTimestamp}&{eventType}",
                "response_datas_key": "events",
                "base": "https://api.hubapi.com/email/public/v1/events",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/events"
                    },
                    {
                        "name": "emailCampaignId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "appId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "app_id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1000
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": ""
                    },
                    {
                        "name": "eventType",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "OPEN"
                    },
                    {
                        "name": "startTimestamp",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1640995200000
                    },
                    {
                        "name": "endTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    }
                ]
            }
        }
    },
    {
        "email_events_forward_since_2022": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": true,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "data_source": {
                "name": "campaigns",
                "raw_sql": "select id, app_id from {schema}.campaigns"
            },
            "model": "email_events",
            "update_key": "id",
            "query": {
                "template": "{base}?{emailCampaignId}&{appId}&{limit}&{offset}&{startTimestamp}&{endTimestamp}&{eventType}",
                "response_datas_key": "events",
                "base": "https://api.hubapi.com/email/public/v1/events",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/events"
                    },
                    {
                        "name": "emailCampaignId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "appId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "app_id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1000
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": ""
                    },
                    {
                        "name": "eventType",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "FORWARD"
                    },
                    {
                        "name": "startTimestamp",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1640995200000
                    },
                    {
                        "name": "endTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    }
                ]
            }
        }
    },
    {
        "company_contact_associations": {
            "actions": [
                "insert"
            ],
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "model": "company_contact_associations",
            "data_source": {
                "name": "companies",
                "raw_sql": "select distinct(id) from {schema}.companies"
            },
            "fields_to_add_to_api_result": [
                {
                    "name": "company_id",
                    "origin_key": "company_id",
                    "destination_key": "company_id"
                }
            ],
            "key_for_values": "contact_id",
            "query": {
                "e_type": "rest",
                "template": "{base}/{company_id}/{association_type}?{limit}&{offset}",
                "response_datas_key": "results",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/crm-associations/v1/associations/"
                    },
                    {
                        "name": "company_id",
                        "type": "db",
                        "data_source_name": "companies",
                        "source_key": "id",
                        "output_type": "arg"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 100
                    },
                    {
                        "name": "association_type",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "/HUBSPOT_DEFINED/2"
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 0
                    }
                ]
            }
        }
    },
    {
        "email_events_click_daily": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": true,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "data_source": {
                "name": "campaigns",
                "raw_sql": "select id, app_id from {schema}.campaigns"
            },
            "model": "email_events",
            "update_key": "id",
            "query": {
                "template": "{base}?{emailCampaignId}&{appId}&{limit}&{offset}&{startTimestamp}&{endTimestamp}&{eventType}",
                "response_datas_key": "events",
                "base": "https://api.hubapi.com/email/public/v1/events",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/events"
                    },
                    {
                        "name": "emailCampaignId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "appId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "app_id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1000
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": ""
                    },
                    {
                        "name": "eventType",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "CLICK"
                    },
                    {
                        "name": "startTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "start",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "endTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    }
                ]
            }
        }
    },
    {
        "email_events_open_daily": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": true,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "data_source": {
                "name": "campaigns",
                "raw_sql": "select id, app_id from {schema}.campaigns"
            },
            "model": "email_events",
            "update_key": "id",
            "query": {
                "template": "{base}?{emailCampaignId}&{appId}&{limit}&{offset}&{startTimestamp}&{endTimestamp}&{eventType}",
                "response_datas_key": "events",
                "base": "https://api.hubapi.com/email/public/v1/events",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/events"
                    },
                    {
                        "name": "emailCampaignId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "appId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "app_id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1000
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": ""
                    },
                    {
                        "name": "eventType",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "OPEN"
                    },
                    {
                        "name": "startTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "start",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "endTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    }
                ]
            }
        }
    },
    {
        "email_events_forward_daily": {
            "actions": [
                "insert"
            ],
            "exclude_existing_in_db": true,
            "source": "hubspot",
            "destination": "redshift",
            "request_data_source": "redshift",
            "destination_unique_keys": [
                "id"
            ],
            "data_source": {
                "name": "campaigns",
                "raw_sql": "select id, app_id from {schema}.campaigns"
            },
            "model": "email_events",
            "update_key": "id",
            "query": {
                "template": "{base}?{emailCampaignId}&{appId}&{limit}&{offset}&{startTimestamp}&{endTimestamp}&{eventType}",
                "response_datas_key": "events",
                "base": "https://api.hubapi.com/email/public/v1/events",
                "params": [
                    {
                        "name": "base",
                        "type": "constant",
                        "output_type": "arg",
                        "value": "https://api.hubapi.com/email/public/v1/events"
                    },
                    {
                        "name": "emailCampaignId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "appId",
                        "type": "db",
                        "data_source_name": "campaigns",
                        "source_key": "app_id",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "limit",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": 1000
                    },
                    {
                        "name": "offset",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": ""
                    },
                    {
                        "name": "eventType",
                        "type": "constant",
                        "output_type": "kwarg",
                        "value": "FORWARD"
                    },
                    {
                        "name": "startTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "start",
                        "output_type": "kwarg"
                    },
                    {
                        "name": "endTimestamp",
                        "type": "timestamp_from_epoch",
                        "offset_type": "from_today",
                        "offset_value": "1",
                        "offset_unity": "days",
                        "position": "end",
                        "output_type": "kwarg"
                    }
                ]
            }
        }
    }
]